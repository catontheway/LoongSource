--任务描述

Quest_GuJian = {}
Quest_GuJian[1]={TargetType=QuestTargetType["Kill"], TargetID1=1003105, TargetID2=0, TargetID3=0, TargetID4=0, Num1=20, Num2=0, Num3=0, Num4=0, MsgID=18001}--龙城--赤穗强盗
Quest_GuJian[2]={TargetType=QuestTargetType["Kill"], TargetID1=1003134, TargetID2=0, TargetID3=0, TargetID4=0, Num1=20, Num2=0, Num3=0, Num4=0, MsgID=18001}--龙城--松岩山贼
Quest_GuJian[3]={TargetType=QuestTargetType["Kill"], TargetID1=1004010, TargetID2=1004011, TargetID3=1004012, TargetID4=0, Num1=20, Num2=0, Num3=0, Num4=0, MsgID=18002}--凤翔--青冥匪众
Quest_GuJian[4]={TargetType=QuestTargetType["Kill"], TargetID1=1004101, TargetID2=1004102, TargetID3=1004103, TargetID4=0, Num1=25, Num2=0, Num3=0, Num4=0, MsgID=18002}--凤翔--斑纹豹
Quest_GuJian[5]={TargetType=QuestTargetType["Kill"], TargetID1=1004122, TargetID2=1004123, TargetID3=0, TargetID4=0, Num1=25, Num2=0, Num3=0, Num4=0, MsgID=18002}--凤翔--利齿花妖
Quest_GuJian[6]={TargetType=QuestTargetType["Kill"], TargetID1=1004132, TargetID2=1004133, TargetID3=1004134, TargetID4=0, Num1=25, Num2=0, Num3=0, Num4=0, MsgID=18002}--凤翔--赤血兽人
Quest_GuJian[7]={TargetType=QuestTargetType["Kill"], TargetID1=1004213, TargetID2=1004214, TargetID3=1004215, TargetID4=0, Num1=25, Num2=0, Num3=0, Num4=0, MsgID=18002}--凤翔--蓝镶山贼
Quest_GuJian[8]={TargetType=QuestTargetType["Kill"], TargetID1=1004233, TargetID2=1004234, TargetID3=0, TargetID4=0, Num1=25, Num2=0, Num3=0, Num4=0, MsgID=18002}--凤翔--万毒教药师
Quest_GuJian[9]={TargetType=QuestTargetType["Kill"], TargetID1=1004301, TargetID2=1004302, TargetID3=1004303, TargetID4=0, Num1=28, Num2=0, Num3=0, Num4=0, MsgID=18002}--凤翔--反叛劳工
Quest_GuJian[10]={TargetType=QuestTargetType["Kill"], TargetID1=1004319, TargetID2=1004320, TargetID3=0, TargetID4=0, Num1=28, Num2=0, Num3=0, Num4=0, MsgID=18002}--凤翔--叛匪兵丁
Quest_GuJian[11]={TargetType=QuestTargetType["Kill"], TargetID1=1004329, TargetID2=1004330, TargetID3=0, TargetID4=0, Num1=28, Num2=0, Num3=0, Num4=0, MsgID=18002}--凤翔--幻彩魔女
Quest_GuJian[12]={TargetType=QuestTargetType["Kill"], TargetID1=1005109, TargetID2=1005110, TargetID3=0, TargetID4=0, Num1=28, Num2=0, Num3=0, Num4=0, MsgID=18003}--涿鹿--水始兽人
Quest_GuJian[13]={TargetType=QuestTargetType["Kill"], TargetID1=1005121, TargetID2=0, TargetID3=0, TargetID4=0, Num1=28, Num2=0, Num3=0, Num4=0, MsgID=18003}--涿鹿--银翅翼人
Quest_GuJian[14]={TargetType=QuestTargetType["Kill"], TargetID1=1005203, TargetID2=1005204, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18003}--涿鹿--山地蝎
Quest_GuJian[15]={TargetType=QuestTargetType["Kill"], TargetID1=1005219, TargetID2=1005220, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18003}--涿鹿--涿鹿游牧
Quest_GuJian[16]={TargetType=QuestTargetType["Kill"], TargetID1=1005306, TargetID2=1005307, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18003}--涿鹿--百邪狼妖
Quest_GuJian[17]={TargetType=QuestTargetType["Kill"], TargetID1=1005313, TargetID2=1005314, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18003}--涿鹿--翠瑶花精
Quest_GuJian[18]={TargetType=QuestTargetType["Kill"], TargetID1=1005321, TargetID2=1005322, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18003}--涿鹿--肥遗猿妖
Quest_GuJian[19]={TargetType=QuestTargetType["Kill"], TargetID1=1006146, TargetID2=0, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18001}--龙城--苍莽宵小
Quest_GuJian[20]={TargetType=QuestTargetType["Kill"], TargetID1=1006217, TargetID2=0, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18001}--巫水--轻甲刀兵
Quest_GuJian[21]={TargetType=QuestTargetType["Kill"], TargetID1=1006302, TargetID2=0, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18004}--巫水--化绵女妖
Quest_GuJian[22]={TargetType=QuestTargetType["Kill"], TargetID1=1006314, TargetID2=0, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18004}--巫水--铁册毒师
Quest_GuJian[23]={TargetType=QuestTargetType["Kill"], TargetID1=1006325, TargetID2=1006329, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18004}--巫水--叛军残兵
Quest_GuJian[24]={TargetType=QuestTargetType["Kill"], TargetID1=1006406, TargetID2=0, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18004}--巫水--盘阳蛇妖
Quest_GuJian[25]={TargetType=QuestTargetType["Kill"], TargetID1=1006417, TargetID2=1006418, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18004}--巫水--阿罗耶亲兵
Quest_GuJian[26]={TargetType=QuestTargetType["Kill"], TargetID1=1007032, TargetID2=0, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18005}--武夷--叶绿小妖
Quest_GuJian[27]={TargetType=QuestTargetType["Kill"], TargetID1=1007151, TargetID2=1007152, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18005}--武夷--丧门毒蜂
Quest_GuJian[28]={TargetType=QuestTargetType["Kill"], TargetID1=1007128, TargetID2=1007129, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18005}--武夷--龙吟贼盗
Quest_GuJian[29]={TargetType=QuestTargetType["Kill"], TargetID1=1007163, TargetID2=1007164, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18005}--武夷--佛语花妖
Quest_GuJian[30]={TargetType=QuestTargetType["Kill"], TargetID1=1007175, TargetID2=0, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18005}--武夷--铁血兽人
Quest_GuJian[31]={TargetType=QuestTargetType["Kill"], TargetID1=1007203, TargetID2=1007237, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18005}--武夷--食腐野狼
Quest_GuJian[32]={TargetType=QuestTargetType["Kill"], TargetID1=1009005, TargetID2=1009006, TargetID3=0, TargetID4=0, Num1=30, Num2=0, Num3=0, Num4=0, MsgID=18006}--昆仑--踏雪狐
Quest_GuJian[33]={TargetType=QuestTargetType["Kill"], TargetID1=1009020, TargetID2=1009021, TargetID3=0, TargetID4=0, Num1=10, Num2=0, Num3=0, Num4=0, MsgID=18006}--昆仑--亡命狂徒
Quest_GuJian[34]={TargetType=QuestTargetType["Kill"], TargetID1=1009053, TargetID2=0, TargetID3=0, TargetID4=0, Num1=20, Num2=0, Num3=0, Num4=0, MsgID=18006}--昆仑--蚀骨魔狼
Quest_GuJian[35]={TargetType=QuestTargetType["Kill"], TargetID1=1009108, TargetID2=0, TargetID3=0, TargetID4=0, Num1=20, Num2=0, Num3=0, Num4=0, MsgID=18006}--昆仑--驭蝎山魈
Quest_GuJian[36]={TargetType=QuestTargetType["Kill"], TargetID1=1009132, TargetID2=0, TargetID3=0, TargetID4=0, Num1=20, Num2=0, Num3=0, Num4=0, MsgID=18006}--昆仑--赤隐山妖
Quest_GuJian[37]={TargetType=QuestTargetType["Kill"], TargetID1=1009138, TargetID2=0, TargetID3=0, TargetID4=0, Num1=20, Num2=0, Num3=0, Num4=0, MsgID=18006}--昆仑--青绝匪勇
Quest_GuJian[38]={TargetType=QuestTargetType["Kill"], TargetID1=1009221, TargetID2=0, TargetID3=0, TargetID4=0, Num1=20, Num2=0, Num3=0, Num4=0, MsgID=18006}--昆仑--昆仑雪豹




--接取任务
function q20104_OnQuestInit(MapID, InstanceID, QuestID, RoleID, NPCID)

--随机得到表中的一个索引

	local Index = 0
	--获取玩家等级
	local rolelevel = role.GetRoleLevel(MapID, InstanceID, RoleID)

	--根据玩家等级随机选择任务目标
	Index = math.floor((rolelevel-25)/2)+1

	if Index > 38 then
	    Index = 38
	end


	--初始化任务的动态数据
	role.QuestInit(RoleID, QuestID, GetRandQuestTable(Quest_GuJian, Index))

	local MsgID = msg.BeginMsgEvent()
	msg.AddMsgEvent(MsgID, 11, QuestID)
	msg.AddMsgEvent(MsgID, 1, Quest_GuJian[Index].MsgID)
	msg.DispatchRoleMsgEvent(RoleID, MsgID)
end

--完成任务
function q20104_OnComplete(MapID, InstanceID, QuestID, RoleID, NPCID)

	local exp_award = {}
	exp_award[25]=2725
	exp_award[30]=3350
	exp_award[35]=3975
	exp_award[40]=4600
	exp_award[45]=5650
	exp_award[50]=6700
	exp_award[55]=7750
	exp_award[60]=9060
	exp_award[65]=10760
	exp_award[70]=12120
	exp_award[75]=14160
	exp_award[80]=16200
	exp_award[85]=17800
	exp_award[90]=21000
	exp_award[95]=25200
	exp_award[100]=30276

	local k = math.floor(role.GetRoleLevel(MapID, InstanceID, RoleID)/5)*5
	if k>100 then
		k = 100
	end

	--奖励玩家经验
	role.AddRoleExp(MapID, InstanceID, RoleID, exp_award[k]*2)
	--增加进阶实力值
		Increase_shili(MapID, InstanceID, RoleID, 0, 4, "jinjieshili_Q")
end

aux.RegisterQuestEvent(20104, 1, "q20104_OnComplete")
aux.RegisterQuestEvent(20104, 7, "q20104_OnQuestInit")
